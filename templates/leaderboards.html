{% extends "base.html" %}
{% load static %}

{% block title %}Leaderboards ¬∑ Multilingo{% endblock %}

{% block content %}
<style>
    .leaderboards-layout {
        display: grid;
        grid-template-columns: 280px 1fr 380px;
        gap: 24px;
        max-width: 1600px;
        margin: 0 auto;
        padding: 24px;
        min-height: calc(100vh - 80px);
    }

    .leaderboards-main {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        max-width: 800px;
        margin: 0 auto;
        padding: 40px 24px;
    }

    .medals-display {
        display: flex;
        gap: 20px;
        margin-bottom: 40px;
        align-items: center;
    }

    .medal {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 48px;
        position: relative;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
    }

    .medal.bronze {
        background: linear-gradient(135deg, #cd7f32 0%, #8b5a2b 100%);
    }

    .medal.gold {
        background: linear-gradient(135deg, #ffd700 0%, #ffa500 100%);
        transform: scale(1.2);
        z-index: 1;
    }

    .medal.silver {
        background: linear-gradient(135deg, #c0c0c0 0%, #808080 100%);
    }

    .leaderboards-locked-content {
        text-align: center;
        max-width: 500px;
    }

    .leaderboards-locked-content h1 {
        font-size: 40px;
        font-weight: 900;
        color: var(--duo-text);
        margin-bottom: 16px;
    }

    .leaderboards-locked-content p {
        font-size: 18px;
        color: var(--duo-text-light);
        margin-bottom: 32px;
        line-height: 1.6;
    }

    .lessons-progress {
        background: white;
        border: 2px solid var(--duo-gray);
        border-radius: 16px;
        padding: 24px;
        margin-bottom: 32px;
        width: 100%;
    }

    .lessons-progress-text {
        font-size: 16px;
        font-weight: 700;
        color: var(--duo-text);
        margin-bottom: 12px;
        text-align: center;
    }

    .lessons-progress-bar {
        width: 100%;
        height: 16px;
        background: #f0f0f0;
        border-radius: 8px;
        overflow: hidden;
        margin-bottom: 8px;
    }

    .lessons-progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #1cb0f6 0%, #0e8fd3 100%);
        border-radius: 8px;
        transition: width 0.3s ease;
    }

    .lessons-count-text {
        font-size: 14px;
        color: var(--duo-text-light);
        text-align: center;
    }

    .placeholder-leaderboard {
        background: white;
        border: 2px solid var(--duo-gray);
        border-radius: 16px;
        padding: 32px;
        width: 100%;
        opacity: 0.5;
    }

    .placeholder-row {
        display: flex;
        align-items: center;
        gap: 16px;
        padding: 16px;
        border-bottom: 1px solid var(--duo-gray);
    }

    .placeholder-row:last-child {
        border-bottom: none;
    }

    .placeholder-rank {
        width: 32px;
        height: 32px;
        background: #e5e5e5;
        border-radius: 50%;
    }

    .placeholder-avatar {
        width: 48px;
        height: 48px;
        background: #e5e5e5;
        border-radius: 50%;
    }

    .placeholder-info {
        flex: 1;
    }

    .placeholder-bar {
        height: 16px;
        background: #e5e5e5;
        border-radius: 8px;
        margin-bottom: 8px;
    }

    .placeholder-bar.short {
        width: 60%;
    }

    .placeholder-bar.shorter {
        width: 40%;
    }

    .placeholder-score {
        width: 60px;
        height: 24px;
        background: #e5e5e5;
        border-radius: 8px;
    }

    @media (max-width: 1200px) {
        .leaderboards-layout {
            grid-template-columns: 1fr 380px;
        }
    }

    @media (max-width: 900px) {
        .leaderboards-layout {
            grid-template-columns: 1fr;
        }
    }

    /* Animated Dolphin Styles */
    .dolphin-container {
        display: inline-block;
        width: 100px;
        height: 100px;
        margin: 0 auto;
        perspective: 1000px;
    }

    .dolphin-animated {
        width: 100%;
        height: 100%;
        animation: twirl 3s ease-in-out infinite;
        transform-style: preserve-3d;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .dolphin-svg {
        width: 80px;
        height: 80px;
        filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.2));
    }

    @keyframes twirl {
        0% {
            transform: rotateY(0deg) rotateZ(0deg);
        }
        25% {
            transform: rotateY(180deg) rotateZ(-10deg);
        }
        50% {
            transform: rotateY(360deg) rotateZ(0deg);
        }
        75% {
            transform: rotateY(540deg) rotateZ(10deg);
        }
        100% {
            transform: rotateY(720deg) rotateZ(0deg);
        }
    }
</style>

<div class="leaderboards-layout">
    <!-- Left Sidebar -->
    <aside class="left-sidebar">
        <nav class="sidebar-nav">
            <a href="{% url 'home' %}" class="sidebar-nav-item">
                <span class="sidebar-nav-icon">üè†</span>
                <span>LEARN</span>
            </a>
            <!--
            <a href="#" class="sidebar-nav-item">
                <span class="sidebar-nav-icon">üí™</span>
                <span>PRACTICE</span>
            </a>
            -->
            <a href="{% url 'leaderboards' %}" class="sidebar-nav-item active">
                <span class="sidebar-nav-icon">üèÜ</span>
                <span>LEADERBOARDS</span>
            </a>
            <a href="{% url 'quests' %}" class="sidebar-nav-item">
                <span class="sidebar-nav-icon">üéØ</span>
                <span>QUESTS</span>
            </a>
            <!--
            <a href="{% url 'shop' %}" class="sidebar-nav-item">
                <span class="sidebar-nav-icon">üõçÔ∏è</span>
                <span>SHOP</span>
            </a>
            -->
            <a href="{% url 'user_profile' %}" class="sidebar-nav-item">
                <span class="sidebar-nav-icon">üë§</span>
                <span>PROFILE</span>
            </a>
            <!--
            <a href="#" class="sidebar-nav-item">
                <span class="sidebar-nav-icon">‚ãØ</span>
                <span>MORE</span>
            </a>
            -->
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="leaderboards-main">
        {% if not is_unlocked %}
            <!-- Medals Display -->
            <div class="medals-display">
                <div class="medal bronze">ü•â</div>
                <div class="medal gold">ü•á</div>
                <div class="medal silver">ü•à</div>
            </div>

            <!-- Locked Content -->
            <div class="leaderboards-locked-content">
                <h1>Unlock Leaderboards!</h1>
                <p>Complete {{ lessons_needed }} more lesson{{ lessons_needed|pluralize }} to start competing</p>

                <!-- Progress -->
                <div class="lessons-progress">
                    <div class="lessons-progress-text">
                        Lesson Progress
                    </div>
                    <div class="lessons-progress-bar">
                        <div class="lessons-progress-fill" style="width: {% widthratio completed_lessons_count 10 100 %}%;"></div>
                    </div>
                    <div class="lessons-count-text">
                        {{ completed_lessons_count }} / 10 lessons completed
                    </div>
                </div>

                <a href="{% url 'home' %}" class="btn" style="padding: 16px 48px; font-size: 16px;">
                    START A LESSON
                </a>

                <!-- Placeholder Leaderboard -->
                <div class="placeholder-leaderboard" style="margin-top: 40px;">
                    {% for i in "12345"|make_list %}
                        <div class="placeholder-row">
                            <div class="placeholder-rank"></div>
                            <div class="placeholder-avatar"></div>
                            <div class="placeholder-info">
                                <div class="placeholder-bar {% if forloop.counter|divisibleby:2 %}short{% else %}shorter{% endif %}"></div>
                            </div>
                            <div class="placeholder-score"></div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        {% else %}
            <!-- TODO: Implement actual leaderboard view when unlocked -->
            <div style="text-align: center;">
                <h1 style="font-size: 40px; margin-bottom: 16px;">üèÜ Leaderboards</h1>
                <p style="font-size: 18px; color: var(--duo-text-light);">
                    Leaderboard functionality coming soon!
                </p>
            </div>
        {% endif %}
    </main>

    <!-- Right Sidebar -->
    <aside class="right-sidebar">
        <!-- User Stats -->
        <div class="user-stats-bar">
            <div class="stat-item">
                <span class="stat-icon">üî•</span>
                <span class="stat-value">{{ profile.streak_days }}</span>
            </div>
            <div class="stat-item">
                <span class="stat-icon">üíé</span>
                <span class="stat-value">{{ profile.gems }}</span>
            </div>
            <div class="stat-item">
                <span class="stat-icon">‚ù§Ô∏è</span>
                <span class="stat-value">{{ profile.hearts }}</span>
            </div>
        </div>

        <!-- Info Card -->
        <div class="sidebar-card">
            <h3>What are Leaderboards?</h3>
            <div style="margin-top: 16px; font-size: 14px; color: var(--duo-text-light); line-height: 1.6;">
                <p style="margin-bottom: 12px;">
                    <strong style="color: var(--duo-text);">Do lessons. Earn XP. Compete.</strong>
                </p>
                <p>
                    Earn XP through lessons, then compete with players in a weekly leaderboard.
                </p>
            </div>
            <div style="margin-top: 20px; text-align: center;">
                <div class="dolphin-container">
                    <div class="dolphin-animated">
                        <svg class="dolphin-svg" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <!-- Dolphin body -->
                            <path d="M45 32C45 38.627 39.627 44 33 44C26.373 44 21 38.627 21 32C21 25.373 26.373 20 33 20C39.627 20 45 25.373 45 32Z" fill="#4A9FD8"/>
                            <!-- Dolphin head -->
                            <ellipse cx="40" cy="28" rx="8" ry="10" fill="#5BB5E8"/>
                            <!-- Snout -->
                            <path d="M46 26C48 26 50 27 50 29C50 31 48 32 46 32C44 32 44 29 46 26Z" fill="#5BB5E8"/>
                            <!-- Eye -->
                            <circle cx="42" cy="27" r="2" fill="#2C3E50"/>
                            <circle cx="42.5" cy="26.5" r="0.8" fill="white"/>
                            <!-- Dorsal fin -->
                            <path d="M33 18C33 18 31 12 28 10C28 10 30 14 33 18Z" fill="#4A9FD8"/>
                            <!-- Tail -->
                            <path d="M21 32C21 32 15 30 12 28C12 28 10 32 12 36C12 36 15 34 21 32Z" fill="#4A9FD8"/>
                            <path d="M21 32C21 32 15 34 12 36C12 36 10 32 12 28C12 28 15 30 21 32Z" fill="#5BB5E8"/>
                            <!-- Belly highlight -->
                            <ellipse cx="30" cy="35" rx="6" ry="4" fill="#B8E6F5" opacity="0.6"/>
                            <!-- Pectoral fin -->
                            <path d="M28 35C28 35 24 38 22 40C22 40 26 38 28 35Z" fill="#4A9FD8"/>
                        </svg>
                    </div>
                </div>
                <p style="font-size: 12px; color: var(--duo-text-light);">
                    Join the competition and climb the ranks!
                </p>
            </div>
        </div>

        <!-- Motivational Card -->
        <div class="sidebar-card" style="background: linear-gradient(135deg, #1cb0f6 0%, #0e8fd3 100%); color: white; border: none;">
            <h3 style="color: white;">Keep Learning! üöÄ</h3>
            <p style="margin-top: 12px; font-size: 14px; opacity: 0.95; line-height: 1.6;">
                {% if not is_unlocked %}
                    You're {{ lessons_needed }} lesson{{ lessons_needed|pluralize }} away from competing with learners worldwide!
                {% else %}
                    Great job unlocking leaderboards! Keep earning XP to climb the ranks.
                {% endif %}
            </p>
        </div>
    </aside>
</div>
{% endblock %}